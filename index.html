<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì¸ìŠë¦° ì €í•­ì„± ì˜ˆì¸¡ ì„¤ë¬¸ (ì •ë°€)</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Inter í°íŠ¸ ì„¤ì • ë° ì‹ ë¢°ê° ìˆëŠ” ë‘¥ê·¼ ë””ìì¸ */
        html { font-family: 'Inter', sans-serif; }
        body {
            background-color: #ffffff; /* í°ìƒ‰ ë°°ê²½ ìœ ì§€ */
            padding: 1rem;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            min-height: 100vh;
        }
        #app-container {
            width: 100%;
            max-width: 520px; /* ëª¨ë°”ì¼/íƒœë¸”ë¦¿ ìµœì í™” */
            background-color: #ffffff;
            border-radius: 1.5rem; /* ë‘¥ê·¼ ëª¨ì„œë¦¬ ê°•ì¡° */
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            padding: 2rem;
        }
        /* í‘¸ë¥¸ìƒ‰ ê³„ì—´ì˜ UI ê°•ì¡° */
        .blue-primary {
            background-color: #3b82f6; /* blue-500 */
        }
        .blue-primary:hover {
            background-color: #2563eb; /* blue-600 */
        }
        /* ì…ë ¥ í•„ë“œ ìŠ¤íƒ€ì¼ */
        input[type="text"], input[type="number"], .bmi-display {
            border: 1px solid #d1d5db;
            padding: 0.75rem;
            border-radius: 0.75rem; /* ë‘¥ê·¼ ì…ë ¥ í•„ë“œ */
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
            transition: border-color 0.2s;
        }
        input[type="text"]:focus, input[type="number"]:focus {
            border-color: #3b82f6;
            outline: none;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.3);
        }
        /* ë¼ë””ì˜¤ ë²„íŠ¼ ì»¨í…Œì´ë„ˆ ìŠ¤íƒ€ì¼ */
        .question-option {
            padding: 0.75rem;
            border: 1px solid #e5e7eb;
            border-radius: 0.75rem;
            margin-bottom: 0.5rem;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
        }
        .question-option:hover {
            background-color: #eff6ff; /* blue-50 */
        }
        input[type="radio"]:checked ~ span {
            font-weight: 600;
            color: #1d4ed8; /* blue-700 */
        }
        input[type="radio"]:checked ~ .question-option {
            border-color: #60a5fa; /* blue-400 */
            background-color: #eff6ff;
        }
    </style>
</head>
<body>
    <div id="app-container">
        <header class="text-center mb-8">
            <h1 class="text-3xl font-extrabold text-gray-800">ì¸ìŠë¦° ì €í•­ì„± ì˜ˆì¸¡ ì„¤ë¬¸</h1>
            <p class="text-sm text-gray-500 mt-2">ì •ë°€ ìœ„í—˜ ìš”ì†Œ ê¸°ë°˜ ì˜ˆì¸¡ (ì´ 8ë¬¸í•­)</p>
        </header>
        
        <!-- ì„¤ë¬¸ í•­ëª© ì„¹ì…˜ -->
        <div id="survey-section" class="space-y-8">

            <!-- 1. ê¸°ë³¸ ì •ë³´ ì…ë ¥ ë° BMI ê³„ì‚° -->
            <fieldset class="p-5 border border-blue-200 rounded-xl bg-blue-50">
                <legend class="text-lg font-bold text-blue-700 mb-4 px-2">ê¸°ë³¸ ì •ë³´ ì…ë ¥ (í•„ìˆ˜)</legend>
                <div class="space-y-3">
                    <label class="block">
                        <span class="text-sm font-medium text-gray-700">ì´ë¦„</span>
                        <input type="text" id="name" placeholder="í™˜ì ì´ë¦„" class="w-full mt-1">
                    </label>
                    <label class="block">
                        <span class="text-sm font-medium text-gray-700">ë‚˜ì´ (ë§Œ ë‚˜ì´, ì ìˆ˜ ê°€ì¤‘ì¹˜ ì ìš©)</span>
                        <input type="number" id="age" placeholder="ë§Œ ë‚˜ì´" min="10" class="w-full mt-1">
                    </label>
                    <div class="grid grid-cols-2 gap-3">
                        <label class="block">
                            <span class="text-sm font-medium text-gray-700">í‚¤ (cm)</span>
                            <input type="number" id="height" placeholder="ì˜ˆ: 170" min="50" step="0.1" class="w-full mt-1" oninput="calculateBMI()">
                        </label>
                        <label class="block">
                            <span class="text-sm font-medium text-gray-700">ì²´ì¤‘ (kg)</span>
                            <input type="number" id="weight" placeholder="ì˜ˆ: 70" min="10" step="0.1" class="w-full mt-1" oninput="calculateBMI()">
                        </label>
                    </div>
                    <div class="block">
                        <span class="text-sm font-medium text-gray-700">BMI (ìë™ ê³„ì‚°)</span>
                        <div id="bmi-result" class="bmi-display w-full mt-1 bg-white text-gray-800 font-semibold h-12 flex items-center px-4">
                            --
                        </div>
                    </div>
                </div>
            </fieldset>

            <!-- 2. ì‹ ì²´ í™œë™ (ì ìˆ˜ ê°€ì¤‘ì¹˜ ì ìš©) -->
            <fieldset class="p-4 border border-gray-200 rounded-xl">
                <legend class="text-md font-semibold text-gray-800 mb-3 px-2">2. ì‹ ì²´ í™œë™ëŸ‰ (1ì£¼ì¼ì— 4ì‹œê°„ ì´ìƒ ìš´ë™)</legend>
                <div class="space-y-2">
                    <label class="question-option">
                        <input type="radio" name="q2_activity" value="0" class="hidden">
                        <span class="ml-2 text-gray-700 flex-1">ì˜ˆ: ì£¼ 4íšŒ ì´ìƒ (ì´ 4ì‹œê°„ ì´ìƒ, ê°€ë²¼ìš´ í™œë™ í¬í•¨)</span>
                    </label>
                    <label class="question-option">
                        <input type="radio" name="q2_activity" value="2" class="hidden">
                        <span class="ml-2 text-gray-700 flex-1">ì•„ë‹ˆì˜¤: 1ì£¼ì¼ì— 4ì‹œê°„ ë¯¸ë§Œ í™œë™ (2ì )</span>
                    </label>
                </div>
            </fieldset>

            <!-- 3. íƒ„ìˆ˜í™”ë¬¼/ë‹¨ ìŒì‹ ì¤‘ë…ì„± -->
            <fieldset class="p-4 border border-gray-200 rounded-xl">
                <legend class="text-md font-semibold text-gray-800 mb-3 px-2">3. íƒ„ìˆ˜í™”ë¬¼ ë° ë‹¨ ìŒì‹ ê°ˆë§/ì¤‘ë…</legend>
                <div class="space-y-2">
                    <label class="question-option">
                        <input type="radio" name="q3_craving" value="0" class="hidden">
                        <span class="ml-2 text-gray-700 flex-1">ì—†ê±°ë‚˜ ê°€ë” (ì‹ì‚¬ í›„ ë§Œì¡±í•¨)</span>
                    </label>
                    <label class="question-option">
                        <input type="radio" name="q3_craving" value="2" class="hidden">
                        <span class="ml-2 text-gray-700 flex-1">ìì£¼/ì‹¬í•˜ê²Œ (ì‹í›„ì—ë„ ë¹µ, ë‹¨ ìŒë£Œ, ê°„ì‹ ë“±ì„ ì°¾ìŒ) (2ì )</span>
                    </label>
                </div>
            </fieldset>
            
            <!-- 4. ì •ì œ íƒ„ìˆ˜í™”ë¬¼ ë° ê°€ê³µìœ¡ ì„­ì·¨ ë¹ˆë„ (ì‹ ê·œ) -->
            <fieldset class="p-4 border border-gray-200 rounded-xl">
                <legend class="text-md font-semibold text-gray-800 mb-3 px-2">4. ì •ì œëœ ê³¡ë¬¼, ê°€ê³µìœ¡ (í–„, ì†Œì‹œì§€), ê°€ë‹¹ ìŒë£Œ ì„­ì·¨ ë¹ˆë„</legend>
                <div class="space-y-2">
                    <label class="question-option">
                        <input type="radio" name="q4_processed_food" value="0" class="hidden">
                        <span class="ml-2 text-gray-700 flex-1">ì£¼ 1íšŒ ë¯¸ë§Œ ë˜ëŠ” ê±°ì˜ ì—†ìŒ</span>
                    </label>
                    <label class="question-option">
                        <input type="radio" name="q4_processed_food" value="2" class="hidden">
                        <span class="ml-2 text-gray-700 flex-1">ì£¼ 2íšŒ ì´ìƒ ë˜ëŠ” ë§¤ì¼ ì„­ì·¨ (2ì )</span>
                    </label>
                </div>
            </fieldset>

            <!-- 5. ì¥ì –/í‘ìƒ‰ê·¹ì„¸í¬ì¦ (ì‹ ê·œ) -->
            <fieldset class="p-4 border border-gray-200 rounded-xl">
                <legend class="text-md font-semibold text-gray-800 mb-3 px-2">5. í”¼ë¶€ ì¦ìƒ: ì¥ì – ë˜ëŠ” í‘ìƒ‰ê·¹ì„¸í¬ì¦ ìœ ë¬´</legend>
                <div class="space-y-2">
                    <label class="question-option">
                        <input type="radio" name="q5_skin" value="0" class="hidden">
                        <span class="ml-2 text-gray-700 flex-1">ì¥ì –(Skin Tag)ì´ ì—†ê±°ë‚˜, ëª©/ê²¨ë“œë‘ì´ í”¼ë¶€ê°€ ê²€ê²Œ ë‘êº¼ì›Œì§€ì§€ ì•ŠìŒ</span>
                    </label>
                    <label class="question-option">
                        <input type="radio" name="q5_skin" value="3" class="hidden">
                        <span class="ml-2 text-gray-700 flex-1">ëª©ì´ë‚˜ ê²¨ë“œë‘ì´ì— ì¥ì –ì´ ë§ê±°ë‚˜, í”¼ë¶€ê°€ ê²€ê³  ë‘êº¼ì›Œì§€ëŠ” í˜„ìƒ(í‘ìƒ‰ê·¹ì„¸í¬ì¦)ì´ ìˆìŒ (3ì )</span>
                    </label>
                </div>
            </fieldset>
            
            <!-- 6. ê³ í˜ˆì•• ì•½ ë³µìš© ë° ê³ í˜ˆë‹¹ ê²½í—˜ -->
            <fieldset class="p-4 border border-gray-200 rounded-xl">
                <legend class="text-md font-semibold text-gray-800 mb-3 px-2">6. ê³ í˜ˆì•• ì•½ ë³µìš© ë° ê³¼ê±° ê³ í˜ˆë‹¹ ê²½í—˜</legend>
                <div class="space-y-2">
                    <label class="question-option">
                        <input type="radio" name="q6_bp_med" value="0" class="hidden">
                        <span class="ml-2 text-gray-700 flex-1">ê³ í˜ˆì•• ì•½ ë³µìš© ê²½í—˜ ë° ê³ í˜ˆë‹¹ ì§„ë‹¨ ì´ë ¥ ì—†ìŒ</span>
                    </label>
                    <label class="question-option">
                        <input type="radio" name="q6_bp_med" value="2" class="hidden">
                        <span class="ml-2 text-gray-700 flex-1">ê³ í˜ˆì••ìœ¼ë¡œ ì•½ì„ ë³µìš© ì¤‘ì´ê±°ë‚˜ ê³¼ê±° ê³ í˜ˆë‹¹ ì§„ë‹¨ì„ ë°›ì€ ì ì´ ìˆë‹¤. (2ì )</span>
                    </label>
                </div>
            </fieldset>

            <!-- 7. ì±„ì†Œ/ê³¼ì¼ ì„­ì·¨ ë¹ˆë„ -->
            <fieldset class="p-4 border border-gray-200 rounded-xl">
                <legend class="text-md font-semibold text-gray-800 mb-3 px-2">7. ì±„ì†Œ, ê³¼ì¼, ê³¡ë¬¼ ì„­ì·¨ ë¹ˆë„</legend>
                <div class="space-y-2">
                    <label class="question-option">
                        <input type="radio" name="q7_diet_veg" value="0" class="hidden">
                        <span class="ml-2 text-gray-700 flex-1">ë§¤ì¼ ì„­ì·¨í•œë‹¤</span>
                    </label>
                    <label class="question-option">
                        <input type="radio" name="q7_diet_veg" value="1" class="hidden">
                        <span class="ml-2 text-gray-700 flex-1">ë§¤ì¼ ì„­ì·¨í•˜ì§€ ì•ŠëŠ”ë‹¤ (1ì )</span>
                    </label>
                </div>
            </fieldset>

            <!-- 8. ê°€ì¡±ë ¥ (ê°€ì¥ ë†’ì€ ê°€ì¤‘ì¹˜) -->
            <fieldset class="p-4 border border-gray-200 rounded-xl">
                <legend class="text-md font-semibold text-gray-800 mb-3 px-2">8. ê°€ì¡± ì¤‘ ë‹¹ë‡¨ë³‘ ì§„ë‹¨ ì´ë ¥</legend>
                <div class="space-y-2">
                    <label class="question-option">
                        <input type="radio" name="q8_family" value="0" class="hidden">
                        <span class="ml-2 text-gray-700 flex-1">ì—†ë‹¤</span>
                    </label>
                    <label class="question-option">
                        <input type="radio" name="q8_family" value="3" class="hidden">
                        <span class="ml-2 text-gray-700 flex-1">2ì°¨ ì¹œì¡± (ì¡°ë¶€ëª¨, ì´ëª¨/ê³ ëª¨, ì‚¼ì´Œ/ì™¸ì‚¼ì´Œ ë“±) ì¤‘ ì§„ë‹¨ ì´ë ¥ ìˆìŒ (3ì )</span>
                    </label>
                    <label class="question-option">
                        <input type="radio" name="q8_family" value="5" class="hidden">
                        <span class="ml-2 text-gray-700 flex-1">1ì°¨ ì¹œì¡± (ë¶€ëª¨, í˜•ì œ/ìë§¤, ìë…€) ì¤‘ ì§„ë‹¨ ì´ë ¥ ìˆìŒ (5ì )</span>
                    </label>
                </div>
            </fieldset>


            <!-- ê³„ì‚° ë²„íŠ¼ -->
            <button onclick="calculateScore()"
                    class="w-full blue-primary text-white font-bold py-4 px-4 rounded-xl transition duration-150 shadow-lg hover:shadow-xl focus:outline-none focus:ring-4 focus:ring-blue-500 focus:ring-opacity-50 mt-8 text-xl">
                ì¸ìŠë¦° ì €í•­ì„± ì˜ˆì¸¡ ì ìˆ˜ í™•ì¸
            </button>
        </div>
        
        <!-- ê²°ê³¼ í‘œì‹œë¥¼ ìœ„í•œ Hidden Box (í•˜ë‹¨ìœ¼ë¡œ ì´ë™) -->
        <div id="result-box" class="hidden p-6 mt-8 mb-8 rounded-xl border-4 border-blue-400 bg-blue-50 transition-all duration-300">
            <h2 class="text-2xl font-semibold text-blue-700 mb-3">âœ… ì˜ˆì¸¡ ê²°ê³¼</h2>
            <p class="text-lg font-bold text-gray-800 mb-2">ì´ ìœ„í—˜ ì ìˆ˜: <span id="prediction-score" class="text-3xl ml-2 text-red-600"></span>ì  (ìµœëŒ€ 25ì )</p>
            <p class="text-md text-gray-700 mb-4">ì˜ˆì¸¡ ìœ„í—˜ë„: <span id="prediction-status" class="font-bold ml-1"></span></p>

            <div class="p-3 text-sm text-gray-700 bg-yellow-100 rounded-lg mb-4 border border-yellow-300">
                <p class="font-semibold text-yellow-800 mb-1">ğŸ’¡ ê²°ê³¼ ì „ì†¡ ì‹œ ìœ ì˜ì‚¬í•­</p>
                <p>ì „ì†¡ ì‹¤íŒ¨ ë° ë°ì´í„° ì†ì‹¤ ë°©ì§€ë¥¼ ìœ„í•´, **ë¨¼ì € [ê²°ê³¼ ë³µì‚¬í•˜ê¸°]**ë¥¼ ëˆŒëŸ¬ ë‚´ìš©ì„ ì €ì¥í•´ ì£¼ì„¸ìš”.</p>
            </div>

            <div class="flex space-x-3 mt-4">
                <!-- ê²°ê³¼ ë³µì‚¬ ë²„íŠ¼ (1ìˆœìœ„ ì‚¬ìš© ê¶Œì¥) -->
                <button onclick="copyToClipboard()" id="copy-button"
                        class="flex-1 bg-gray-500 hover:bg-gray-600 text-white font-bold py-3 px-4 rounded-xl transition duration-150 shadow-md hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-opacity-50 text-sm">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 inline-block mr-1" viewBox="0 0 20 20" fill="currentColor"><path d="M7 9a2 2 0 012-2h6a2 2 0 012 2v6a2 2 0 01-2 2H9a2 2 0 01-2-2V9z" /><path d="M5 3a2 2 0 00-2 2v6a2 2 0 002 2V5h6a2 2 0 00-2-2H5z" /></svg>
                    ê²°ê³¼ ë³µì‚¬í•˜ê¸°
                </button>

                <!-- ì´ë©”ì¼ ì „ì†¡ ë²„íŠ¼ (2ìˆœìœ„ ì‚¬ìš© ê¶Œì¥) -->
                <button onclick="sendEmail()" id="email-button"
                        class="flex-1 blue-primary text-white font-bold py-3 px-4 rounded-xl transition duration-150 shadow-lg hover:shadow-xl focus:outline-none focus:ring-4 focus:ring-blue-500 focus:ring-opacity-50 text-sm">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 inline-block mr-1" viewBox="0 0 20 20" fill="currentColor"><path d="M2.003 5.884L10 9.882l7.997-3.998A2 2 0 0016 4H4a2 2 0 00-1.997 1.884z" /><path d="M18 8.118l-8 4-8-4V14a2 2 0 002 2h12a2 2 0 002-2V8.118z" /></svg>
                    í•œì˜ì›ì— ê²°ê³¼ ì „ì†¡
                </button>
            </div>
        </div>

        <!-- ì•ˆë‚´ ë° ì£¼ì˜ì‚¬í•­ -->
        <footer class="mt-10 pt-4 border-t border-gray-200">
            <h3 class="text-sm font-semibold text-gray-700 mb-2">ì˜ˆì¸¡ ì ìˆ˜ ê¸°ì¤€ ë° ì°¸ê³ ì‚¬í•­</h3>
            <ul class="text-xs text-gray-500 space-y-1 list-disc pl-4">
                <li>ì´ì  ë²”ìœ„: 0ì  ~ 25ì  (ë‚˜ì´ì™€ BMIì— ë”°ë¼ ìµœëŒ€ ì ìˆ˜ ë³€ë™)</li>
                <li>ì´ ì„¤ë¬¸ì€ ì¸ìŠë¦° ì €í•­ì„±ê³¼ ê´€ë ¨ëœ ì£¼ìš” ì˜í•™ì  ì§€í‘œ(FINDRISC, í”¼ë¶€ ì¦ìƒ, ì‹ìŠµê´€)ë¥¼ ì°¸ê³ í•˜ì—¬ ì¬êµ¬ì„±í•œ ê²ƒì…ë‹ˆë‹¤.</li>
                <li>**ê²½ê³ :** ì´ ì„¤ë¬¸ì€ ì°¸ê³ ìš©ì´ë©°, ì •í™•í•œ ì§„ë‹¨ì€ ë°˜ë“œì‹œ í•œì˜ì›ì´ë‚˜ ì „ë¬¸ ì˜ë£Œê¸°ê´€ì˜ ê²€ì§„ì„ í†µí•´ ë°›ìœ¼ì…”ì•¼ í•©ë‹ˆë‹¤.</li>
            </ul>
        </footer>
    </div>

    <script>
        // í•œì˜ì› ì´ë©”ì¼ ì£¼ì†Œ ì„¤ì •
        const HANUIWON_EMAIL = "port0312@naver.com";

        /**
         * 1. í‚¤ì™€ ì²´ì¤‘ì„ ê¸°ë°˜ìœ¼ë¡œ BMIë¥¼ ê³„ì‚°í•˜ê³  í™”ë©´ì— í‘œì‹œí•©ë‹ˆë‹¤.
         */
        function calculateBMI() {
            const heightCm = parseFloat(document.getElementById('height').value);
            const weightKg = parseFloat(document.getElementById('weight').value);
            const bmiDisplay = document.getElementById('bmi-result');

            if (heightCm > 0 && weightKg > 0) {
                // BMI = ì²´ì¤‘(kg) / (í‚¤(m) * í‚¤(m))
                const heightM = heightCm / 100;
                const bmi = weightKg / (heightM * heightM);
                bmiDisplay.textContent = bmi.toFixed(2);
                bmiDisplay.classList.remove('text-gray-800');
                bmiDisplay.classList.add('text-blue-600');
            } else {
                bmiDisplay.textContent = '--';
                bmiDisplay.classList.remove('text-blue-600');
                bmiDisplay.classList.add('text-gray-800');
            }
        }
        
        /**
         * 2. ëª¨ë“  ì„¤ë¬¸ í•­ëª©ì„ í™•ì¸í•˜ê³  ì ìˆ˜ë¥¼ ê³„ì‚°í•˜ì—¬ ê²°ê³¼ë¥¼ í‘œì‹œí•©ë‹ˆë‹¤.
         * ë‚˜ì´, BMI, 8ê°€ì§€ ì§ˆë¬¸ì˜ ê°€ì¤‘ì¹˜ë¥¼ ì¢…í•©í•˜ì—¬ ì´ì ì„ ì‚°ì¶œí•©ë‹ˆë‹¤.
         */
        function calculateScore() {
            let totalScore = 0;
            let isAllAnswered = true;
            const userName = document.getElementById('name').value.trim();
            const userAge = parseInt(document.getElementById('age').value);
            const userBMI = parseFloat(document.getElementById('bmi-result').textContent);

            // 1. ê¸°ë³¸ ì •ë³´ ìœ íš¨ì„± ê²€ì‚¬
            if (!userName || isNaN(userAge) || isNaN(userBMI) || userAge < 10 || userBMI === '--') {
                displayMessage('ì´ë¦„, ë‚˜ì´, í‚¤, ì²´ì¤‘ì„ ëª¨ë‘ ì •í™•íˆ ì…ë ¥í•´ ì£¼ì„¸ìš”.', 'bg-red-100 border-red-400 text-red-700');
                document.getElementById('result-box').classList.add('hidden');
                return;
            }
            
            // 2. ë‚˜ì´ ì ìˆ˜ ê°€ì¤‘ì¹˜ (FINDRISC ê¸°ë°˜)
            if (userAge >= 45 && userAge <= 54) {
                totalScore += 2;
            } else if (userAge >= 55 && userAge <= 64) {
                totalScore += 3;
            } else if (userAge >= 65) {
                totalScore += 4;
            }
            
            // 3. BMI ì ìˆ˜ ê°€ì¤‘ì¹˜ (FINDRISC ê¸°ë°˜)
            if (userBMI >= 25.0 && userBMI <= 29.9) {
                totalScore += 1;
            } else if (userBMI >= 30.0) {
                totalScore += 3;
            }

            // 4. ê¸°íƒ€ ì„¤ë¬¸ í•­ëª© ì ìˆ˜ í•©ì‚°
            const questionNames = ['q2_activity', 'q3_craving', 'q4_processed_food', 'q5_skin', 'q6_bp_med', 'q7_diet_veg', 'q8_family'];
            questionNames.forEach(name => {
                const checkedRadio = document.querySelector(`input[name="${name}"]:checked`);
                if (checkedRadio) {
                    totalScore += parseInt(checkedRadio.value, 10);
                } else {
                    isAllAnswered = false;
                }
            });

            // 5. ì„¤ë¬¸ ì‘ë‹µ ì™„ë£Œ ê²€ì¦
            if (!isAllAnswered) {
                displayMessage('ì„¤ë¬¸ í•­ëª©ì„ ëª¨ë‘ ì„ íƒí•´ ì£¼ì„¸ìš”.', 'bg-red-100 border-red-400 text-red-700');
                document.getElementById('result-box').classList.add('hidden');
                return;
            }

            // 6. ìµœì¢… íŒì • ê¸°ì¤€ ì„¤ì • (ìµœëŒ€ ì ìˆ˜ ì•½ 25ì  ê¸°ì¤€)
            let statusText = '';
            let statusColor = 'text-green-600';
            let comment = '';

            if (totalScore <= 8) {
                statusText = 'ì €ìœ„í—˜êµ° (ì–‘í˜¸)';
                statusColor = 'text-green-600';
                comment = 'í˜„ì¬ ìœ„í—˜ë„ê°€ ë‚®ìŠµë‹ˆë‹¤. ì¢‹ì€ ìƒí™œ ìŠµê´€ì„ ìœ ì§€í•´ ì£¼ì„¸ìš”. 1ë…„ ì£¼ê¸°ë¡œ ì¬í™•ì¸í•´ ë³´ì‹œëŠ” ê²ƒì„ ê¶Œì¥í•©ë‹ˆë‹¤.';
            } else if (totalScore >= 9 && totalScore <= 15) {
                statusText = 'ì¤‘ê°„ ìœ„í—˜êµ° (ê°œì„  í•„ìš”)';
                statusColor = 'text-yellow-600';
                comment = 'ì¸ìŠë¦° ì €í•­ì„± ìœ„í—˜ ìš”ì†Œê°€ ë°œê²¬ë˜ì—ˆìŠµë‹ˆë‹¤. ì‹ë‹¨, ìš´ë™, ìˆ˜ë©´ ê°œì„ ì„ ìœ„í•œ í•œì˜í•™ì  ìƒë‹´ì„ ë°›ì•„ë³´ì„¸ìš”.';
            } else { // totalScore >= 16
                statusText = 'ê³ ìœ„í—˜êµ° (ì „ë¬¸ ìƒë‹´ ë° ê²€ì‚¬ ê°•ë ¥ ê¶Œê³ )';
                statusColor = 'text-red-600';
                comment = 'ì¸ìŠë¦° ì €í•­ì„±ì´ ë†’ì„ ê°€ëŠ¥ì„±ì´ ë§¤ìš° ë†’ìŠµë‹ˆë‹¤. ì§€ì²´ ì—†ì´ í•œì˜ì›ì— ë°©ë¬¸í•˜ì—¬ ì •ë°€ ê²€ì‚¬ ë° ë§ì¶¤ ì¹˜ë£Œ ìƒë‹´ì„ ì‹œì‘í•´ì•¼ í•©ë‹ˆë‹¤.';
            }

            // 7. ê²°ê³¼ í‘œì‹œ ì—…ë°ì´íŠ¸
            document.getElementById('prediction-score').textContent = totalScore;
            document.getElementById('prediction-status').textContent = statusText;
            document.getElementById('prediction-status').className = 'font-bold ml-1 ' + statusColor;
            
            // ì´ë©”ì¼ ì „ì†¡ì„ ìœ„í•œ ìµœì¢… ê²°ê³¼ ì½”ë©˜íŠ¸ ì €ì¥
            window.finalComment = comment;
            window.finalStatus = statusText;
            window.finalScore = totalScore;

            // ê²°ê³¼ ìƒì í‘œì‹œ ë° ì˜¤ë¥˜ ë©”ì‹œì§€ ì´ˆê¸°í™”
            document.getElementById('result-box').classList.remove('hidden');
            removeMessage();
        }

        /**
         * ì´ë©”ì¼ ë³¸ë¬¸ì— ë“¤ì–´ê°ˆ ì „ì²´ í…ìŠ¤íŠ¸ë¥¼ ìƒì„±í•˜ì—¬ ë°˜í™˜í•©ë‹ˆë‹¤.
         */
        function generateEmailBody() {
            const score = window.finalScore || 'ë¯¸ê³„ì‚°';
            const statusText = window.finalStatus || 'ì•Œ ìˆ˜ ì—†ìŒ';
            const comment = window.finalComment || 'ê²°ê³¼ë¥¼ í™•ì¸í•˜ê³  ì´ë©”ì¼ì„ ì „ì†¡í•©ë‹ˆë‹¤.';
            const currentDate = new Date().toLocaleDateString('ko-KR');

            const userName = document.getElementById('name').value.trim() || 'ë¯¸ì…ë ¥';
            const userAge = document.getElementById('age').value || 'ë¯¸ì…ë ¥';
            const userBMI = document.getElementById('bmi-result').textContent || 'ë¯¸ê³„ì‚°';
            
            
            // ì„¤ë¬¸ ì‘ë‹µ ëª©ë¡ ìƒì„±
            const questionMap = {
                'q2_activity': '2. ì‹ ì²´ í™œë™ëŸ‰',
                'q3_craving': '3. íƒ„ìˆ˜í™”ë¬¼/ë‹¨ ìŒì‹ ê°ˆë§',
                'q4_processed_food': '4. ì •ì œ/ê°€ê³µì‹í’ˆ ì„­ì·¨ ë¹ˆë„',
                'q5_skin': '5. í”¼ë¶€ ì¦ìƒ (ì¥ì –/í‘ìƒ‰ê·¹ì„¸í¬ì¦)',
                'q6_bp_med': '6. í˜ˆì••ì•½/ê³ í˜ˆë‹¹ ì´ë ¥',
                'q7_diet_veg': '7. ì±„ì†Œ/ê³¼ì¼ ì„­ì·¨ ë¹ˆë„',
                'q8_family': '8. ë‹¹ë‡¨ë³‘ ê°€ì¡±ë ¥'
            };
            let answers = [];

            // ê¸°ë³¸ ì •ë³´ í¬í•¨
            answers.push(`[í™˜ìëª…] : ${userName}`);
            answers.push(`[ë‚˜ì´/BMI] : ë§Œ ${userAge}ì„¸, BMI ${userBMI}`);

            // ì„¤ë¬¸ í•­ëª© ì‘ë‹µ
            Object.keys(questionMap).forEach(name => {
                const checkedRadio = document.querySelector(`input[name="${name}"]:checked`);
                // ì‘ë‹µ ì˜µì…˜ í…ìŠ¤íŠ¸ë¥¼ ê°€ì ¸ì˜¤ê³  ì ìˆ˜(3ì , 5ì  ë“±) í‘œê¸° ì œê±°
                const answerText = checkedRadio ? checkedRadio.nextElementSibling.textContent.trim().replace(/\s*\(\dì \)$/, '') : 'ë¯¸ì‘ë‹µ';
                answers.push(`[${questionMap[name]}] : ${answerText}`);
            });
            const answerList = answers.join('\n');


            // ì´ë©”ì¼/ë³µì‚¬ìš© ë³¸ë¬¸ ì‘ì„±
            const body = `[${currentDate} ì¸ìŠë¦° ì €í•­ì„± ì˜ˆì¸¡ ì„¤ë¬¸ ê²°ê³¼]\n` +
                         `--------------------------------------------------\n` +
                         `[í™˜ì ê¸°ë³¸ ë° ì‘ë‹µ ë‚´ì—­]\n` +
                         `${answerList}\n` +
                         `--------------------------------------------------\n` +
                         `[ìµœì¢… ì˜ˆì¸¡ ê²°ê³¼ ìš”ì•½]\n` +
                         `ì´ ìœ„í—˜ ì ìˆ˜: ${score}ì  (ìµœëŒ€ 25ì )\n` +
                         `ì˜ˆì¸¡ ìœ„í—˜ë„: ${statusText}\n\n` +
                         `-> í•œì˜ì› ìƒë‹´ ê¶Œê³ : ${comment}\n\n` +
                         `*ë³¸ ì„¤ë¬¸ì€ ì°¸ê³ ìš©ì´ë©°, ì •í™•í•œ ì§„ë‹¨ì€ ë‚´ì› ìƒë‹´ì„ í†µí•´ ì´ë£¨ì–´ì ¸ì•¼ í•©ë‹ˆë‹¤.`;
            return body;
        }

        /**
         * ê²°ê³¼ë¥¼ ì´ë©”ì¼ë¡œ ì „ì†¡í•˜ê¸° ìœ„í•œ mailto ë§í¬ë¥¼ ìƒì„±í•˜ê³  ì‹¤í–‰í•©ë‹ˆë‹¤.
         */
        function sendEmail() {
            if (!document.getElementById('prediction-score').textContent || document.getElementById('prediction-score').textContent === '0') {
                 displayMessage('ë¨¼ì € "ì˜ˆì¸¡ ì ìˆ˜ í™•ì¸" ë²„íŠ¼ì„ ëˆŒëŸ¬ ê²°ê³¼ë¥¼ ê³„ì‚°í•´ ì£¼ì„¸ìš”.', 'bg-yellow-100 border-yellow-400 text-yellow-700');
                 return;
            }
            
            const body = generateEmailBody();
            const currentDate = new Date().toLocaleDateString('ko-KR');
            const userName = document.getElementById('name').value.trim() || 'ë¯¸ì…ë ¥';
            
            const recipient = HANUIWON_EMAIL; 
            const subject = encodeURIComponent(`[í™˜ì ì„¤ë¬¸] ${userName}ë‹˜ì˜ ${currentDate} ì¸ìŠë¦° ì €í•­ì„± ì˜ˆì¸¡ ê²°ê³¼`);
            const encodedBody = encodeURIComponent(body);

            // mailto ë§í¬ ìƒì„±: mailto:ìˆ˜ì‹ ìì£¼ì†Œ?ì œëª©&ë³¸ë¬¸
            const mailtoLink = `mailto:${recipient}?subject=${subject}&body=${encodedBody}`;
            window.location.href = mailtoLink;
        }

        /**
         * ìƒì„±ëœ ê²°ê³¼ë¥¼ í´ë¦½ë³´ë“œì— ë³µì‚¬í•©ë‹ˆë‹¤.
         */
        function copyToClipboard() {
            if (!document.getElementById('prediction-score').textContent || document.getElementById('prediction-score').textContent === '0') {
                 displayMessage('ë¨¼ì € "ì˜ˆì¸¡ ì ìˆ˜ í™•ì¸" ë²„íŠ¼ì„ ëˆŒëŸ¬ ê²°ê³¼ë¥¼ ê³„ì‚°í•´ ì£¼ì„¸ìš”.', 'bg-yellow-100 border-yellow-400 text-yellow-700');
                 return;
            }

            const textToCopy = generateEmailBody();
            
            try {
                navigator.clipboard.writeText(textToCopy);
                displayMessage('ê²°ê³¼ í…ìŠ¤íŠ¸ê°€ í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤. (ì´ë©”ì¼, ì¹´ì¹´ì˜¤í†¡ ë“±ì— ë¶™ì—¬ë„£ê¸° ê°€ëŠ¥)', 'bg-emerald-100 border-emerald-400 text-emerald-700');
            } catch (err) {
                 // ëŒ€ì²´ ë°©ë²• (document.execCommand)
                const textArea = document.createElement('textarea');
                textArea.value = textToCopy;
                document.body.appendChild(textArea);
                textArea.focus();
                textArea.select();
                try {
                    document.execCommand('copy');
                    displayMessage('ê²°ê³¼ í…ìŠ¤íŠ¸ê°€ í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤. (ëŒ€ì²´ ë°©ë²• ì‚¬ìš©)', 'bg-emerald-100 border-emerald-400 text-emerald-700');
                } catch (err) {
                    displayMessage('ë³µì‚¬ ê¸°ëŠ¥ì´ ì§€ì›ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.', 'bg-red-100 border-red-400 text-red-700');
                }
                document.body.removeChild(textArea);
            }
        }

        /**
         * ì‚¬ìš©ìì—ê²Œ ë©”ì‹œì§€ë¥¼ í‘œì‹œí•˜ëŠ” ì„ì‹œ í•¨ìˆ˜ (alert ëŒ€ì²´)
         */
        function displayMessage(text, className) {
            removeMessage();
            const container = document.getElementById('app-container');
            const messageElement = document.createElement('div');
            messageElement.id = 'temp-message';
            messageElement.className = `p-4 my-4 rounded-xl font-medium shadow-md ${className}`;
            messageElement.textContent = text;
            const surveySection = document.getElementById('survey-section');
            
            // ë©”ì‹œì§€ë¥¼ ì„¤ë¬¸ ì„¹ì…˜ ë°”ë¡œ ìœ„ì— í‘œì‹œ
            container.insertBefore(messageElement, surveySection);
            
            setTimeout(removeMessage, 5000);
        }

        /**
         * í‘œì‹œëœ ë©”ì‹œì§€ë¥¼ ì œê±°í•˜ëŠ” í•¨ìˆ˜
         */
        function removeMessage() {
            const existingMessage = document.getElementById('temp-message');
            if (existingMessage) {
                existingMessage.remove();
            }
        }
    </script>
</body>
</html>
